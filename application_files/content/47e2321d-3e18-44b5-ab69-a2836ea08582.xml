<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <rule>
        <name>MI_MultiTrack_WholeBusiness_ReferralsReport</name>
        <uuid>47e2321d-3e18-44b5-ab69-a2836ea08582</uuid>
        <description>Contains Referrals Report for Whole Business MultiTrack Report</description>
        <parentUuid>_a-0000db2d-0cd0-8000-6ee0-010000010000_25362</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>load(&#xD;
  local!pagingInfo: #&quot;SYSTEM_SYSRULES_pagingInfo&quot;(&#xD;
    startIndex: 1,&#xD;
    batchSize: 10&#xD;
  ),&#xD;
  local!pagingInfo2: #&quot;SYSTEM_SYSRULES_pagingInfo&quot;(&#xD;
    startIndex: 1,&#xD;
    batchSize: 10,&#xD;
    sort: #&quot;SYSTEM_SYSRULES_sortInfo&quot;(&#xD;
      field: &quot;Months&quot;,&#xD;
      ascending: true&#xD;
    )&#xD;
  ),&#xD;
  local!pagingInfoRunrate: #&quot;SYSTEM_SYSRULES_pagingInfo&quot;(&#xD;
    startIndex: 1,&#xD;
    batchSize: 10,&#xD;
    sort: #&quot;SYSTEM_SYSRULES_sortInfo&quot;(&#xD;
      field: &quot;Months&quot;,&#xD;
      ascending: true&#xD;
    )&#xD;
  ),&#xD;
  local!ReferralsCreatedEnd: now(),&#xD;
  local!ReferralsOpenEnd: now(),&#xD;
  local!ReferralRollingMonth: #&quot;_a-0000db0d-1b74-8000-6ee0-010000010000_11229&quot;[12],&#xD;
  local!TotalProducts,&#xD;
  with(&#xD;
    local!ReferralsOpenStart: local!ReferralsOpenEnd - (&#xD;
      30 * local!ReferralRollingMonth&#xD;
    ),&#xD;
    local!ReferralsCreatedStart: local!ReferralsCreatedEnd - (&#xD;
      30 * local!ReferralRollingMonth&#xD;
    ),&#xD;
    /*&#xD;
    /*&#xD;
      Get the Daily Run Rate Datasubset for the Case&#xD;
            BEGIN&#xD;
  */&#xD;
    local!DatasubsetDailyRunRate: if(&#xD;
      #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
        local!ProviderID&#xD;
      ),&#xD;
      {},&#xD;
      #&quot;135d6dc6-dbaa-4604-a938-029a68fba772&quot;()&#xD;
    ),&#xD;
    /*&#xD;
      Get the Daily Run Rate Datasubset for the Case&#xD;
            END&#xD;
  */&#xD;
    local!datasubset1: if(&#xD;
      #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
        local!ProviderID&#xD;
      ),&#xD;
      {},&#xD;
      if(&#xD;
        #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
          local!ProviderID&#xD;
        ),&#xD;
        {},&#xD;
        #&quot;SYSTEM_SYSRULES_queryEntity&quot;(&#xD;
          entity: #&quot;_a-0000dbde-d572-8000-6ee0-010000010000_47769&quot;,&#xD;
          query: #&quot;SYSTEM_SYSRULES_query&quot;(&#xD;
            aggregation: #&quot;SYSTEM_SYSRULES_queryAggregation&quot;(&#xD;
              {&#xD;
                #&quot;SYSTEM_SYSRULES_queryAggregationColumn&quot;(&#xD;
                  field: &quot;ProductName&quot;,&#xD;
                  isGrouping: true&#xD;
                ),&#xD;
                #&quot;SYSTEM_SYSRULES_queryAggregationColumn&quot;(&#xD;
                  field: &quot;ID&quot;,&#xD;
                  aggregationFunction: &quot;COUNT&quot;&#xD;
                ),&#xD;
                #&quot;SYSTEM_SYSRULES_queryAggregationColumn&quot;(&#xD;
                  field: &quot;IsFastTrack&quot;,&#xD;
                  aggregationFunction: &quot;SUM&quot;&#xD;
                ),&#xD;
                #&quot;SYSTEM_SYSRULES_queryAggregationColumn&quot;(&#xD;
                  field: &quot;IsMultiTrack&quot;,&#xD;
                  aggregationFunction: &quot;SUM&quot;&#xD;
                )&#xD;
              }&#xD;
            ),&#xD;
            logicalExpression: if(&#xD;
              or(&#xD;
                and(&#xD;
                  #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                    local!FilterByReferredStartDate&#xD;
                  ),&#xD;
                  #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                    local!FilterByReferredEndDate&#xD;
                  )&#xD;
                ),&#xD;
                and(&#xD;
                  #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                    local!FilterByStartOpenedDate&#xD;
                  ),&#xD;
                  #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                    local!FilterByEndOpenedDate&#xD;
                  )&#xD;
                )&#xD;
              ),&#xD;
              null,&#xD;
              #&quot;SYSTEM_SYSRULES_queryLogicalExpression&quot;(&#xD;
                operator: &quot;AND&quot;,&#xD;
                filters: {&#xD;
                  if(&#xD;
                    or(&#xD;
                      #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                        local!FilterByReferredStartDate&#xD;
                      ),&#xD;
                      #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                        local!FilterByReferredEndDate&#xD;
                      ),&#xD;
                      local!CaseDateRange = #&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[2]&#xD;
                    ),&#xD;
                    null,&#xD;
                    #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                      field: &quot;CreatedDate&quot;,&#xD;
                      operator: &quot;between&quot;,&#xD;
                      value: {&#xD;
                        if(&#xD;
                          month(&#xD;
                            local!FilterByReferredStartDate&#xD;
                          ) = month(&#xD;
                            local!FilterByReferredEndDate&#xD;
                          ),&#xD;
                          todatetime(&#xD;
                            datetext(&#xD;
                              local!FilterByReferredStartDate,&#xD;
                              &quot;dd/MM/yyyy hh:mm&quot;&#xD;
                            )&#xD;
                          ),&#xD;
                          todatetime(&#xD;
                            1 &amp; &quot;/&quot; &amp; month(&#xD;
                              local!FilterByReferredEndDate&#xD;
                            ) &amp; &quot;/&quot; &amp; year(&#xD;
                              local!FilterByReferredEndDate&#xD;
                            ) &amp; &quot; 23:00&quot;&#xD;
                          )&#xD;
                        ),&#xD;
                        todatetime(&#xD;
                          datetext(&#xD;
                            local!FilterByReferredEndDate,&#xD;
                            &quot;dd/MM/yyyy hh:mm&quot;&#xD;
                          )&#xD;
                        )&#xD;
                      }&#xD;
                    )&#xD;
                  ),&#xD;
                  if(&#xD;
                    or(&#xD;
                      #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                        local!FilterByStartOpenedDate&#xD;
                      ),&#xD;
                      #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                        local!FilterByEndOpenedDate&#xD;
                      ),&#xD;
                      local!CaseDateRange = #&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[1]&#xD;
                    ),&#xD;
                    null,&#xD;
                    #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                      field: &quot;DateOpened&quot;,&#xD;
                      operator: &quot;between&quot;,&#xD;
                      value: {&#xD;
                        if(&#xD;
                          month(&#xD;
                            local!FilterByStartOpenedDate&#xD;
                          ) = month(&#xD;
                            local!FilterByEndOpenedDate&#xD;
                          ),&#xD;
                          todatetime(&#xD;
                            datetext(&#xD;
                              local!FilterByStartOpenedDate,&#xD;
                              &quot;dd/MM/yyyy hh:mm&quot;&#xD;
                            )&#xD;
                          ),&#xD;
                          todatetime(&#xD;
                            1 &amp; &quot;/&quot; &amp; month(&#xD;
                              local!FilterByEndOpenedDate&#xD;
                            ) &amp; &quot;/&quot; &amp; year(&#xD;
                              local!FilterByEndOpenedDate&#xD;
                            ) &amp; &quot; 23:00&quot;&#xD;
                          )&#xD;
                        ),&#xD;
                        todatetime(&#xD;
                          datetext(&#xD;
                            local!FilterByEndOpenedDate,&#xD;
                            &quot;dd/MM/yyyy hh:mm&quot;&#xD;
                          )&#xD;
                        )&#xD;
                      }&#xD;
                    )&#xD;
                  ),&#xD;
                  if(&#xD;
                    or(&#xD;
                      #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                        local!FilterByStartClosedDate&#xD;
                      ),&#xD;
                      #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                        local!FilterByEndClosedDate&#xD;
                      )&#xD;
                    ),&#xD;
                    null,&#xD;
                    #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                      field: &quot;DateClosed&quot;,&#xD;
                      operator: &quot;between&quot;,&#xD;
                      value: {&#xD;
                        todatetime(&#xD;
                          datetext(&#xD;
                            local!FilterByStartClosedDate,&#xD;
                            &quot;dd/MM/yyyy hh:mm&quot;&#xD;
                          )&#xD;
                        ),&#xD;
                        todatetime(&#xD;
                          datetext(&#xD;
                            local!FilterByEndClosedDate,&#xD;
                            &quot;dd/MM/yyyy hh:mm&quot;&#xD;
                          )&#xD;
                        )&#xD;
                      }&#xD;
                    )&#xD;
                  ),&#xD;
                  if(&#xD;
                    #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                      local!ProviderID&#xD;
                    ),&#xD;
                    {},&#xD;
                    #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                      field: &quot;ProviderID&quot;,&#xD;
                      operator: &quot;in&quot;,&#xD;
                      value: local!ProviderID&#xD;
                    )&#xD;
                  ),&#xD;
                  if(&#xD;
                    #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                      local!FilterByCM&#xD;
                    ),&#xD;
                    if(&#xD;
                      #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                        local!CaseManager&#xD;
                      ),&#xD;
                      {},&#xD;
                      #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                        field: &quot;CaseManagerName&quot;,&#xD;
                        operator: &quot;in&quot;,&#xD;
                        value: local!CaseManager&#xD;
                      )&#xD;
                    ),&#xD;
                    #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                      field: &quot;CaseManagerName&quot;,&#xD;
                      operator: &quot;=&quot;,&#xD;
                      value: tostring(&#xD;
                        local!FilterByCM&#xD;
                      )&#xD;
                    )&#xD;
                  ),&#xD;
                  if(&#xD;
                    #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                      local!FilterByProduct&#xD;
                    ),&#xD;
                    {},&#xD;
                    #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                      field: &quot;ProductName&quot;,&#xD;
                      operator: &quot;=&quot;,&#xD;
                      value: local!FilterByProduct&#xD;
                    )&#xD;
                  ),&#xD;
                  #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                    field: &quot;ProductName&quot;,&#xD;
                    operator: &quot;not null&quot;&#xD;
                  ),&#xD;
                  if(&#xD;
                    #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                      local!FilterByCustomer&#xD;
                    ),&#xD;
                    {},&#xD;
                    #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                      field: &quot;TopClientName&quot;,&#xD;
                      operator: &quot;=&quot;,&#xD;
                      value: local!FilterByCustomer&#xD;
                    )&#xD;
                  ),&#xD;
                  if(&#xD;
                    #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                      local!FilterByTeam&#xD;
                    ),&#xD;
                    {},&#xD;
                    #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                      field: &quot;TeamId&quot;,&#xD;
                      operator: &quot;=&quot;,&#xD;
                      value: local!FilterByTeam&#xD;
                    )&#xD;
                  ),&#xD;
                  if(&#xD;
                    #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                      local!FilterByBrand&#xD;
                    ),&#xD;
                    {},&#xD;
                    #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                      field: &quot;BrandName&quot;,&#xD;
                      operator: &quot;=&quot;,&#xD;
                      value: local!FilterByBrand&#xD;
                    )&#xD;
                  ),&#xD;
                  if(&#xD;
                    #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                      local!FilterByTeamDept&#xD;
                    ),&#xD;
                    {},&#xD;
                    #&quot;SYSTEM_SYSRULES_queryFilter&quot;(&#xD;
                      field: &quot;ClientName&quot;,&#xD;
                      operator: &quot;=&quot;,&#xD;
                      value: local!FilterByTeamDept&#xD;
                    )&#xD;
                  )&#xD;
                }&#xD;
              )&#xD;
            ),&#xD;
            pagingInfo: local!pagingInfo&#xD;
          )&#xD;
        )&#xD;
      )&#xD;
    ),&#xD;
    local!DataubsetForReferrals: if(&#xD;
      #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
        local!ProviderID&#xD;
      ),&#xD;
      {},&#xD;
      #&quot;be036ac3-3c35-4bfe-8f64-1e835765401e&quot;(&#xD;
        ProviderID: local!ProviderID,&#xD;
        FilterByTeam: local!FilterByTeam,&#xD;
        ReferralsOpenStart: local!ReferralsOpenStart,&#xD;
        ReferralsOpenEnd: local!ReferralsOpenEnd,&#xD;
        FilterByCM: local!FilterByCM,&#xD;
        FilterByProduct: local!FilterByProduct,&#xD;
        ReferralsCreatedStart: local!ReferralsCreatedStart,&#xD;
        FilterByStartClosedDate: local!FilterByStartClosedDate,&#xD;
        FilterByEndClosedDate: local!FilterByEndClosedDate,&#xD;
        CaseManager: local!CaseManager,&#xD;
        FilterByCustomer: local!FilterByCustomer,&#xD;
        ReferralsCreatedEnd: ReferralsCreatedEnd,&#xD;
        FilterByBrand: local!FilterByBrand,&#xD;
        FilterByTeamDept: local!FilterByTeamDept,&#xD;
        CaseDateRange: local!CaseDateRange&#xD;
      )&#xD;
    ),&#xD;
    local!datasubset2: if(&#xD;
      #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
        local!ProviderID&#xD;
      ),&#xD;
      {},&#xD;
      #&quot;755fecb1-66ff-419d-b51e-73fb0a4de907&quot;(&#xD;
        FilterByStartDate: if(&#xD;
          #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
            local!FilterByStartDate&#xD;
          ),&#xD;
          null,&#xD;
          datetext(&#xD;
            local!FilterByStartDate,&#xD;
            &quot;dd/MM/yyyy hh:mm&quot;&#xD;
          )&#xD;
        ),&#xD;
        FilterByEndDate: if(&#xD;
          #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
            local!FilterByEndDate&#xD;
          ),&#xD;
          null,&#xD;
          datetext(&#xD;
            local!FilterByEndDate,&#xD;
            &quot;dd/MM/yyyy hh:mm&quot;&#xD;
          )&#xD;
        ),&#xD;
        Referrals: local!Referrals,&#xD;
        Referrals2: local!Referrals2,&#xD;
        ProviderID: local!ProviderID,&#xD;
        FilterByCM: local!FilterByCM,&#xD;
        Product: local!FilterByProduct,&#xD;
        Customer: local!FilterByCustomer,&#xD;
        Team: local!FilterByTeam,&#xD;
        PagingInfo: local!pagingInfo2,&#xD;
        CaseManager: local!CaseManager,&#xD;
        FilterByEndClosedDate: if(&#xD;
          #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
            local!FilterByEndClosedDate&#xD;
          ),&#xD;
          null,&#xD;
          datetext(&#xD;
            local!FilterByEndClosedDate,&#xD;
            &quot;dd/MM/yyyy hh:mm&quot;&#xD;
          )&#xD;
        ),&#xD;
        FilterByReferredStartDate: if(&#xD;
          #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
            local!FilterByReferredStartDate&#xD;
          ),&#xD;
          null,&#xD;
          if(&#xD;
            if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByReferredStartDate&#xD;
              ),&#xD;
              tointeger(&#xD;
                null&#xD;
              ),&#xD;
              month(&#xD;
                local!FilterByReferredStartDate&#xD;
              )&#xD;
            ) = if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByReferredEndDate&#xD;
              ),&#xD;
              tointeger(&#xD;
                null&#xD;
              ),&#xD;
              month(&#xD;
                local!FilterByReferredEndDate&#xD;
              )&#xD;
            ),&#xD;
            datetext(&#xD;
              local!FilterByReferredStartDate,&#xD;
              &quot;dd/MM/yyyy hh:mm&quot;&#xD;
            ),&#xD;
            if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByReferredEndDate&#xD;
              ),&#xD;
              tointeger(&#xD;
                null&#xD;
              ),&#xD;
              1 &amp; &quot;/&quot; &amp; month(&#xD;
                local!FilterByReferredEndDate&#xD;
              ) &amp; &quot;/&quot; &amp; year(&#xD;
                local!FilterByReferredEndDate&#xD;
              ) &amp; &quot; 23:00&quot;&#xD;
            )&#xD;
          )&#xD;
        ),&#xD;
        FilterByStartClosedDate: if(&#xD;
          #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
            local!FilterByStartClosedDate&#xD;
          ),&#xD;
          null,&#xD;
          datetext(&#xD;
            local!FilterByStartClosedDate,&#xD;
            &quot;dd/MM/yyyy hh:mm&quot;&#xD;
          )&#xD;
        ),&#xD;
        FilterByStartOpenedDate: if(&#xD;
          #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
            local!FilterByStartOpenedDate&#xD;
          ),&#xD;
          null,&#xD;
          if(&#xD;
            if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByStartOpenedDate&#xD;
              ),&#xD;
              tointeger(&#xD;
                null&#xD;
              ),&#xD;
              month(&#xD;
                local!FilterByStartOpenedDate&#xD;
              )&#xD;
            ) = if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByEndOpenedDate&#xD;
              ),&#xD;
              tointeger(&#xD;
                null&#xD;
              ),&#xD;
              month(&#xD;
                local!FilterByEndOpenedDate&#xD;
              )&#xD;
            ),&#xD;
            datetext(&#xD;
              local!FilterByStartOpenedDate,&#xD;
              &quot;dd/MM/yyyy hh:mm&quot;&#xD;
            ),&#xD;
            if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByEndOpenedDate&#xD;
              ),&#xD;
              tointeger(&#xD;
                null&#xD;
              ),&#xD;
              1 &amp; &quot;/&quot; &amp; month(&#xD;
                local!FilterByEndOpenedDate&#xD;
              ) &amp; &quot;/&quot; &amp; year(&#xD;
                local!FilterByEndOpenedDate&#xD;
              ) &amp; &quot; 23:00&quot;&#xD;
            )&#xD;
          )&#xD;
        ),&#xD;
        FilterByReferredEndDate: if(&#xD;
          #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
            local!FilterByReferredEndDate&#xD;
          ),&#xD;
          null,&#xD;
          datetext(&#xD;
            local!FilterByReferredEndDate,&#xD;
            &quot;dd/MM/yyyy hh:mm&quot;&#xD;
          )&#xD;
        ),&#xD;
        FilterByEndOpenedDate: if(&#xD;
          #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
            local!FilterByEndOpenedDate&#xD;
          ),&#xD;
          null,&#xD;
          datetext(&#xD;
            local!FilterByEndOpenedDate,&#xD;
            &quot;dd/MM/yyyy hh:mm&quot;&#xD;
          )&#xD;
        ),&#xD;
        FilterByTeamDept: local!FilterByTeamDept,&#xD;
        FilterByBrand: local!FilterByBrand,&#xD;
        CaseDateRange: local!CaseDateRange,&#xD;
        TotalProducts: local!TotalProducts&#xD;
      )&#xD;
    ),&#xD;
    /*&#xD;
    Export to Excel Logic&#xD;
  */&#xD;
    local!exportUri: if(&#xD;
      local!isdownload = &quot;downloadfile&quot;,&#xD;
      getdatasubsetdownloadlinkfromprocess(&#xD;
        processModelUuid: &quot;0003db24-e7fb-8000-6ee0-010000010000&quot;,&#xD;
        input: #&quot;SYSTEM_SYSRULES_toJson&quot;(&#xD;
          {&#xD;
            FilterByStartDate: if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByStartDate&#xD;
              ),&#xD;
              null,&#xD;
              datetext(&#xD;
                local!FilterByStartDate,&#xD;
                &quot;dd/MM/yyyy hh:mm&quot;&#xD;
              )&#xD;
            ),&#xD;
            FilterByEndDate: if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByEndDate&#xD;
              ),&#xD;
              null,&#xD;
              datetext(&#xD;
                local!FilterByEndDate,&#xD;
                &quot;dd/MM/yyyy hh:mm&quot;&#xD;
              )&#xD;
            ),&#xD;
            Referrals: local!Referrals,&#xD;
            Referrals2: local!Referrals2,&#xD;
            ProviderID: local!ProviderID,&#xD;
            FilterByCM: local!FilterByCM,&#xD;
            FilterByProduct: local!FilterByProduct,&#xD;
            FilterByCustomer: local!FilterByCustomer,&#xD;
            FilterByTeam: local!FilterByTeam,&#xD;
            CaseManager: local!CaseManager,&#xD;
            FilterByEndClosedDate: if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByEndClosedDate&#xD;
              ),&#xD;
              null,&#xD;
              datetext(&#xD;
                local!FilterByEndClosedDate,&#xD;
                &quot;dd/MM/yyyy hh:mm&quot;&#xD;
              )&#xD;
            ),&#xD;
            FilterByReferredStartDate: if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByReferredStartDate&#xD;
              ),&#xD;
              null,&#xD;
              datetext(&#xD;
                local!FilterByReferredStartDate,&#xD;
                &quot;dd/MM/yyyy hh:mm&quot;&#xD;
              )&#xD;
            ),&#xD;
            FilterByStartClosedDate: if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByStartClosedDate&#xD;
              ),&#xD;
              null,&#xD;
              datetext(&#xD;
                local!FilterByStartClosedDate,&#xD;
                &quot;dd/MM/yyyy hh:mm&quot;&#xD;
              )&#xD;
            ),&#xD;
            FilterByStartOpenedDate: if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByStartOpenedDate&#xD;
              ),&#xD;
              null,&#xD;
              datetext(&#xD;
                local!FilterByStartOpenedDate,&#xD;
                &quot;dd/MM/yyyy hh:mm&quot;&#xD;
              )&#xD;
            ),&#xD;
            FilterByReferredEndDate: if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByReferredEndDate&#xD;
              ),&#xD;
              null,&#xD;
              datetext(&#xD;
                local!FilterByReferredEndDate,&#xD;
                &quot;dd/MM/yyyy hh:mm&quot;&#xD;
              )&#xD;
            ),&#xD;
            FilterByEndOpenedDate: if(&#xD;
              #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                local!FilterByEndOpenedDate&#xD;
              ),&#xD;
              null,&#xD;
              datetext(&#xD;
                local!FilterByEndOpenedDate,&#xD;
                &quot;dd/MM/yyyy hh:mm&quot;&#xD;
              )&#xD;
            ),&#xD;
            FilterByTeamDept: local!FilterByTeamDept,&#xD;
            FilterByBrand: local!FilterByBrand,&#xD;
            CaseDateRange: local!CaseDateRange,&#xD;
            TotalProducts: local!TotalProducts&#xD;
          }&#xD;
        )&#xD;
      ),&#xD;
      null&#xD;
    ),&#xD;
    /*&#xD;
    End of Export to Excel Logic&#xD;
  */&#xD;
    if(&#xD;
      or(&#xD;
        and(&#xD;
          local!CaseDateRange = #&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[1],&#xD;
          or(&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!FilterByReferredEndDate&#xD;
            ),&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!FilterByReferredStartDate&#xD;
            )&#xD;
          )&#xD;
        ),&#xD;
        and(&#xD;
          local!CaseDateRange = #&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[2],&#xD;
          or(&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!FilterByStartOpenedDate&#xD;
            ),&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!FilterByEndOpenedDate&#xD;
            )&#xD;
          )&#xD;
        ),&#xD;
        local!CaseDateRange=#&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[3]&#xD;
      ),&#xD;
      #&quot;SYSTEM_SYSRULES_sectionLayout&quot;(&#xD;
        label: &quot;Referrals Received Vs Open&quot;,&#xD;
        firstColumnContents: {&#xD;
          #&quot;SYSTEM_SYSRULES_textField&quot;(&#xD;
            label: &quot;No Data Available&quot;,&#xD;
            readOnly: true&#xD;
          )&#xD;
        }&#xD;
      ),&#xD;
      {&#xD;
        if(&#xD;
          or(&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!datasubset1&#xD;
            ),&#xD;
            and(&#xD;
              local!CaseDateRange=#&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[1],&#xD;
              or(&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByReferredEndDate&#xD;
                ),&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByReferredStartDate&#xD;
                )&#xD;
              )&#xD;
            ),&#xD;
            and(&#xD;
              local!CaseDateRange=#&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[2],&#xD;
              or(&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByStartOpenedDate&#xD;
                ),&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByEndOpenedDate&#xD;
                )&#xD;
              )&#xD;
            ),&#xD;
            and(&#xD;
              local!CaseDateRange=#&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[3]&#xD;
            )&#xD;
          ),&#xD;
          #&quot;SYSTEM_SYSRULES_sectionLayout&quot;(&#xD;
        label: &quot;Referrals Received Vs Open&quot;,&#xD;
        firstColumnContents: {&#xD;
          #&quot;SYSTEM_SYSRULES_textField&quot;(&#xD;
            label: &quot;No Data Available&quot;,&#xD;
            readOnly: true&#xD;
          )&#xD;
        }&#xD;
      ),&#xD;
          {}&#xD;
        ),&#xD;
        if(&#xD;
          or(&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!datasubset1&#xD;
            ),&#xD;
            and(&#xD;
              local!CaseDateRange=#&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[1],&#xD;
              or(&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByReferredEndDate&#xD;
                ),&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByReferredStartDate&#xD;
                )&#xD;
              )&#xD;
            ),&#xD;
            and(&#xD;
              local!CaseDateRange= #&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[2],&#xD;
              or(&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByStartOpenedDate&#xD;
                ),&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByEndOpenedDate&#xD;
                )&#xD;
              )&#xD;
            ),&#xD;
            &#xD;
              local!CaseDateRange=#&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[3]&#xD;
            &#xD;
          ),&#xD;
          {},&#xD;
          #&quot;8433fc36-325d-4b01-83b5-501e1079b865&quot;()&#xD;
        ),&#xD;
        if(&#xD;
          or(&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!datasubset1&#xD;
            ),&#xD;
            and(&#xD;
              local!CaseDateRange=#&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[1],&#xD;
              or(&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByReferredEndDate&#xD;
                ),&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByReferredStartDate&#xD;
                )&#xD;
              )&#xD;
            ),&#xD;
            and(&#xD;
              local!CaseDateRange= #&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[2],&#xD;
              or(&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByStartOpenedDate&#xD;
                ),&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByEndOpenedDate&#xD;
                )&#xD;
              )&#xD;
            ),&#xD;
            and(&#xD;
              local!CaseDateRange= #&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[3]&#xD;
            )&#xD;
          ),&#xD;
          {},&#xD;
          #&quot;a421dc44-21fb-41c5-b98c-30775a97aa30&quot;()&#xD;
        ),&#xD;
        if(&#xD;
          and(&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!Referrals&#xD;
            ),&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!Referrals2&#xD;
            ),&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!TotalProducts&#xD;
            )&#xD;
          ),&#xD;
          {},&#xD;
          #&quot;54831683-4080-4296-a099-894db7315fb7&quot;()&#xD;
        ),&#xD;
        if(&#xD;
          and(&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!Referrals&#xD;
            ),&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!Referrals2&#xD;
            ),&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!TotalProducts&#xD;
            )&#xD;
          ),&#xD;
          {},&#xD;
          #&quot;SYSTEM_SYSRULES_sectionLayout&quot;(&#xD;
            label: &quot;&quot;,&#xD;
            firstColumnContents: {&#xD;
              #&quot;SYSTEM_SYSRULES_ButtonLayout&quot;(&#xD;
                primaryButtons: {&#xD;
                  #&quot;SYSTEM_SYSRULES_ButtonWidget&quot;(&#xD;
                    label: &quot;Export to Excel&quot;,&#xD;
                    style: &quot;PRIMARY&quot;,&#xD;
                    value: &quot;downloadfile&quot;,&#xD;
                    saveInto: local!isdownload&#xD;
                  )&#xD;
                }&#xD;
              )&#xD;
            }&#xD;
          )&#xD;
        ),&#xD;
        if(&#xD;
          local!isdownload = &quot;downloadfile&quot;,&#xD;
          #&quot;SYSTEM_SYSRULES_sectionLayout&quot;(&#xD;
            label: &quot;Export report to excel&quot;,&#xD;
            firstColumnContents: {&#xD;
              #&quot;SYSTEM_SYSRULES_linkField&quot;(&#xD;
                label: &quot;Your excel is ready&quot;,&#xD;
                links: #&quot;SYSTEM_SYSRULES_safeLink&quot;(&#xD;
                  label: &quot;Click here to download&quot;,&#xD;
                  uri: local!exportUri&#xD;
                )&#xD;
              )&#xD;
            }&#xD;
          ),&#xD;
          {}&#xD;
        ),&#xD;
       if(&#xD;
          or(&#xD;
            #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
              local!datasubset1&#xD;
            ),&#xD;
            and(&#xD;
              local!CaseDateRange=#&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[1],&#xD;
              or(&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByReferredEndDate&#xD;
                ),&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByReferredStartDate&#xD;
                )&#xD;
              )&#xD;
            ),&#xD;
            and(&#xD;
              local!CaseDateRange= #&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[2],&#xD;
              or(&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByStartOpenedDate&#xD;
                ),&#xD;
                #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
                  local!FilterByEndOpenedDate&#xD;
                )&#xD;
              )&#xD;
            ),&#xD;
            and(&#xD;
              local!CaseDateRange=#&quot;_a-0000dbb7-3ff9-8000-6ee0-010000010000_46128&quot;[3]&#xD;
            )&#xD;
          ),{}, #&quot;fe37b28b-5305-4f87-af95-8be84a0972a7&quot;()),&#xD;
        if(&#xD;
          #&quot;_a-0000d33c-c5a1-8000-7bd7-760000760000_1541&quot;(&#xD;
            local!DatasubsetDailyRunRate&#xD;
          ),&#xD;
          {},&#xD;
          #&quot;5da70661-807f-49a7-97b7-bb5143f2d11e&quot;()&#xD;
        )&#xD;
      }&#xD;
    )&#xD;
  )&#xD;
)</definition>
        <preferredEditor>interface</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
    </rule>
    <roleMap public="true">
        <role allowForAll="false" inherit="true" name="readers">
            <users/>
            <groups/>
        </role>
        <role allowForAll="false" inherit="true" name="authors">
            <users/>
            <groups/>
        </role>
        <role allowForAll="false" inherit="true" name="administrators">
            <users>
                <userUuid>appcino.admin</userUuid>
            </users>
            <groups/>
        </role>
        <role allowForAll="false" inherit="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role allowForAll="false" inherit="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role allowForAll="false" inherit="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
    <typedValue>
        <type>
            <name>RuleTestConfig</name>
            <namespace>http://www.appian.com/ae/types/2009</namespace>
        </type>
    </typedValue>
</contentHaul>
